@*
 * Copyright 2021 HM Revenue & Customs
 *
 *@

@import controllers.auth.AuthenticatedRequest
@import play.api.i18n.Messages.Implicits._
@import uk.gov.hmrc.govukfrontend.views.html.components._
@import controllers.internal.SurveyOptinDeclinedDetailsForm._
@import scala.util.Random
@this(mainWithHeaders: views.html.main_with_headers,
    govukButton: GovukButton,
    govukCheckboxes: GovukCheckboxes,
    govukTextarea: GovukTextarea,
    govukCharacterCount : GovukCharacterCount)
@(surveyForm: Form[Data], submitSurveyFormAction: Call)(implicit request: AuthenticatedRequest[_], messages: Messages, hostContext: model.HostContext)
@import uk.gov.hmrc.urls.Link
@import uk.gov.hmrc.play.views.html.helpers._

@mainWithHeaders(title = Messages("paperless.survey.optin_declined.title")) {

    <header class="page-header">
        <h1 class="govuk-heading-xl">@Messages("paperless.survey.optin_declined.title")</h1>
    </header>

    <p class="govuk-body">@Messages("paperless.survey.optin_declined.paragraph.1")</p>

    @form(action = submitSurveyFormAction, 'id -> "form-submit-survey", 'novalidate -> "novalidate") {

        @govukCheckboxes(Checkboxes(
            fieldset = None,
            hint = Some(Hint(content = Text(Messages("paperless.survey.optin_declined.hint")))),
            idPrefix = Some("optin-declined-answers"),
            name = "optin-declined-answers",
            items = Random.shuffle(List("d210eccd-9ea1-48fd-a28e-25abbb7508fe", "717c2da0-4411-41ad-9a78-b335786e7107", "a6f84da8-9fd7-440d-915e-2a2f8a543c9b", "bf74f47f-e9ce-4c15-a9aa-1af80a594861", "ca31965c-dd40-4a2c-a606-fe961da485c0")).map(num =>
                CheckboxItem(
                    content = Text(Messages(s"paperless.survey.optin_declined.choice.$num")),
                    id = Some(s"choice-$num"),
                    name = Some(s"choice-$num"),
                    value = "true",
                    checked = surveyForm(s"choice-$num").value.contains("true")
                )
            )
        ))

        @govukCharacterCount(CharacterCount(
            id = "reason",
            name = "reason",
            maxLength = Some(reasonMaxLength),
            threshold = Some(50),
            label = Label(
                isPageHeading = false,
                classes = "govuk-label--s",
                content = Text(Messages("paperless.survey.optin_declined.reason.label"))
            ),
            errorMessage = surveyForm("reason").error.map(err => ErrorMessage(content = Text(messages("paperless.survey.optin_declined.reason.label.error.maxlength")))),
            value = surveyForm("reason").value
        ))

        <p class="govuk-body">
            @govukButton(Button(
                name = Some("submissionType"),
                inputType = Some("submit"),
                content = Text(Messages("paperless.survey.optin_declined.submitButton")),
                attributes = Map(
                    "id" -> "submitSurveyButton",
                    "data-prevent-double-click" -> "true",
                    "value" -> "submitted"
                )
            ))
            @govukButton(Button(
                name = Some("submissionType"),
                inputType = Some("submit"),
                classes = "button-as-link skip-link-button",
                content = Text(Messages("paperless.survey.optin_declined.check.settings.linkText")),
                attributes = Map(
                    "id" -> "skipSurveyButton",
                    "data-prevent-double-click" -> "true",
                    "value" -> "skipped"
                )
            ))
        </p>
    }

}
