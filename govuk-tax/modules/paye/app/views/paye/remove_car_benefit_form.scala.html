@(displayBenefit: models.paye.DisplayBenefit, hasFuelBenefit:Boolean, updateForm: Form[models.paye.RemoveBenefitFormData], currentTaxYearYearsRange: Range)(implicit user: uk.gov.hmrc.common.microservice.domain.User)

@import views.formatting.Dates._
@import org.joda.time.LocalDate
@import views.html.helpers.singleCheckbox

@import views.helpers.CustomHelpers._
@import helper._
@import views.formatting.Strings._
@import views.formatting.Money._
@import views.helpers._

@main(title = "Remove your company benefit", user = Some(user)) {
<h1><span class="pre-heading">service</span> Tell HMRC about a change to your company car</h1>
@defining(joinList(displayBenefit.benefits.map(b => Messages(s"benefitType.${b.benefitType}.title")), s" ${Messages("list.separator.and")} ")) { benefitsTitle =>
<h2 class="benefit-type">Remove your company @benefitsTitle benefit</h2>
}

    <p>Car provided by <span class="employer-name">@displayBenefit.employment.employerName</span></p>
    @if(displayBenefit.car.get.dateCarRegistered.isDefined){<p>Registered on <span class="date-registered">@formatDate(displayBenefit.car.get.dateCarRegistered.get)</span>.</p>}
    <p>Value of car benefit: <span class="amount">@pounds(displayBenefit.benefit.grossAmount)</span></p>

    <p>If <span class="employer-name">@displayBenefit.employment.employerName</span> have stopped providing you with a company car, you can remove the car from your taxable benefits.</p>

    @helper.form(action = controllers.paye.routes.RemoveBenefitController.requestBenefitRemoval(displayBenefit.allBenefitsToString, displayBenefit.benefit.taxYear, displayBenefit.benefit.employmentSequenceNumber)) {

        @helpers.dateFields(updateForm,
                                "withdrawDate",
                                "Date you gave back the car:",
                                currentTaxYearYearsRange,
				Some(""),
                                '_groupDivClass -> "form-field")

        <div class="form-field">

            @singleCheckbox(
                updateForm("agreement"),
                '_id -> "agreement",
                '_inputClass -> "flush--left",
                '_label -> s"${displayBenefit.employment.employerNameOrReference} no longer provide me with a company car",
                '_showConstraints -> false)

        </div>

        @if(hasFuelBenefit){

                <p class="fuel-benefit-info" >We will also remove your fuel benefit.</p>

                 @helpers.fieldGroup(
                    updateForm,
                    Seq(
                        FormField(updateForm("fuelRadio"), Seq(
                            InputType("radio", "sameDateFuel", "I gave them up at the same time", Some("form-field"), Some("label--inlineRadio-right"), Some("flush--left")),
                            InputType("radio", "differentDateFuel", "I gave my fuel on:", Some("form-field--inline"), Some("label--inlineRadio-right"), Some("flush--left")))),
                        FormField(updateForm("fuelWithdrawDate"), Seq(DateControl(currentTaxYearYearsRange)))
                    ),
                    '_label -> "Did you give back your fuel before you gave back the car?",
                    '_groupDivClass -> "form-field",
                    '_valueAfter -> true
                )
        }
        <div class="form-field">
            <input class="button button--next flush--left" type="submit" value="Next" />
        </div>
    }
}

