@(displayBenefit: models.paye.DisplayBenefit, hasFuelBenefit:Boolean, updateForm: Form[models.paye.RemoveBenefitFormData])

@import views.formatting.Dates._
@import org.joda.time.LocalDate
@import views.html.helpers.singleCheckbox

@import views.helpers.CustomHelpers._
@import helper._
@import views.formatting.Strings._

@main(title = "Remove your company benefit") {

@defining(joinList(displayBenefit.benefits.map(b => Messages(s"benefitType.${b.benefitType}.title")), s" ${Messages("list.separator.and")} ")) { benefitsTitle =>
<h2 class="benefit-type">Remove your company @benefitsTitle benefit</h2>
}

    <p>Car provided by <span class="employer-name">@displayBenefit.employment.employerName</span><br/>
    @if(displayBenefit.car.get.dateCarRegistered.isDefined){Registered on <span class="date-registered">@formatDate(displayBenefit.car.get.dateCarRegistered.get)</span>.<br/>}
    Value of car benefit: <span class="amount">Â£@displayBenefit.benefit.grossAmountToString()</span></p>

    <p>If <span class="employer-name">@displayBenefit.employment.employerName</span> have stopped providing you with a company car, you can remove the car from your taxable benefits.</p>

    @helper.form(action = controllers.paye.routes.RemoveBenefitController.requestBenefitRemoval(displayBenefit.allBenefitsToString, displayBenefit.benefit.taxYear, displayBenefit.benefit.employmentSequenceNumber)) {

        @defining(updateForm("withdrawDate")) { withdrawDateField =>
        <div class="@if(withdrawDateField.error.isDefined){error-notification}">
        @if(withdrawDateField.error.isDefined){<p class="error">@Messages(withdrawDateField.errors(0).message)</p>}
        <label>Date you gave back the car: </label>
        <input class="return-date" type="date" name="withdrawDate" value="@{withdrawDateField.value}" />
        </div>
        }
        <div>

            @singleCheckbox(
                updateForm("agreement"),
                '_id -> "agreement",
                '_label -> s"${displayBenefit.employment.employerNameOrReference} no longer provide me with a company car",
                '_showConstraints -> false)

        </div>

        @if(hasFuelBenefit){

                <p class="fuel-benefit-info" >We will also remove your fuel benefit.</p>
                <p>Did you give back your fuel before you gave back the car?</p>



                @defining(updateForm("fuel.radio")) { fuelRadioField =>

                <div class="@if(fuelRadioField.error.isDefined){error-notification}">
                    @if(fuelRadioField.error.isDefined){<p class="error">@Messages(fuelRadioField.errors(0).message)</p>}

                    <input type="radio" class="same-date" name="fuel.radio" value="sameDateFuel" @if( fuelRadioField.value.getOrElse("") == "sameDateFuel"){checked}> I gave them up at the same time</Input> <br/>
                    @defining(updateForm("fuel.withdrawDate")) { fuelwithdrawDateField =>

                    <div class="@if(fuelwithdrawDateField.error.isDefined){error-notification}">
                        @if(fuelwithdrawDateField.error.isDefined){<p class="error">@Messages(fuelwithdrawDateField.errors(0).message)</p>}
                    <input type="radio" class="different-date" name="fuel.radio"  value="differentDateFuel" @if(fuelRadioField.value.getOrElse("") == "differentDateFuel"){checked}> I gave my fuel on:
                            <input class="return-fuel-date" type="date" name="fuel.withdrawDate" value="@{fuelwithdrawDateField.value}"/>
                        }
                    </input>
                    </div>
                </div>
                }
        }

        <input class="button button--next" type="submit" value="Next" />
    }
}

