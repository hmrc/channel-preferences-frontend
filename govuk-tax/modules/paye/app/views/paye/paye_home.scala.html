@(payeOverview: controllers.paye.PayeOverview)

@import views.formatting.Dates._

@main(title = "Your tax home") {

<h2 class="welcome">Welcome, @payeOverview.name</h2>

<section class="overview--no-border">
    <h1 class="overview__heading">Overview</h1>

    @if(payeOverview.lastLogin.isDefined) {
        <div class="overview__last-login">
            Your last login was at @payeOverview.lastLogin.get.
        </div>
    }
    <div class="overview__actions">
        <h2 class="overview__sub-heading">Recent changes</h2>
        <ul class="overview__actions__done" data-recent-changes>
            @if(payeOverview.employmentViews.flatMap(e => e.recentChanges).size > 0) {
                @for(employmentView <- payeOverview.employmentViews) {
                    @for(recentChange <- employmentView.recentChanges) {
                        <li>@Messages(s"recent.changes.${recentChange.messageCode}", formatDate(recentChange.timeOfChange), employmentView.companyName, employmentView.taxCode)</li>
                    }
                }
            } else {
                <li>There are no changes to your tax in the last month.</li>
            }
        </ul>
    </div>
</section>

<section class="overview">
    <h1 class="overview__heading">Pay As You Earn (PAYE)</h1>
    <div class="overview__contacts">
        <div class="overview__contacts__nino">
            National Insurance number: @payeOverview.nino
        </div>
        <ul class="overview__contacts__companies">

            @for(employmentView <- payeOverview.employmentViews) {
            <li>
                <h2 class="overview__contacts__heading">@employmentView.companyName</h2>
                <p>Employed from (@formatDate(employmentView.startDate) to @formatDate(employmentView.endDate, "present"))<p>
                <h3 class="overview__contacts__sub-heading">Income Tax</h3>
                <p class="tax__code">Tax code: @employmentView.taxCode</p>
            </li>
            }

        </ul>
        <p>
            @if(payeOverview.hasBenefits) {
            <a class="cta cta--view-benefits" href="@controllers.paye.routes.PayeController.listBenefits">Click here to see your benefits</a>
            }
        </p>
    </div>
</section>


}
